<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<script type="text/javascript" src="libs/jquery-2.0.0.js"></script>
	<script type="text/javascript" src="libs/underscore.js"></script>
	<script type="text/javascript" src="libs/backbone.js"></script>
	<script type="text/javascript" src="libs/d3.js"></script>
	<script type="text/javascript" src="models/chart-model.js"></script>
	<script type="text/javascript" src="models/data-model.js"></script>
	<script type="text/javascript" src="collections/data-stub-collection.js"></script>
	<script type="text/javascript" src="collections/data-cache-collection.js"></script>
	<script type="text/javascript" src="collections/data-lens-collection.js"></script>
	<script type="text/javascript" src="components/firespray-0.1.2.js"></script>
	<script type="text/javascript" src="views/chart-view.js"></script>
	<link rel="stylesheet" type="text/css" href="style1.css">
	<title></title>
	<style>
		.timeline-chart{
			float: left;
			width: 800px;
			height: 100px;
		}
		.main-chart{
			float: left;
			width: 500px;
			height: 300px;
		}
	</style>
</head>
<body>

<div class="dashboard">
	<div class="timeline-chart"></div>
	<div class="main-chart"></div>
</div>

<script type="text/template" id="chart-template">
	<div class="chart-container"></div>
</script>

<script type="text/javascript">

// singleton query manager and data cache
var now = new Date().setMilliseconds(0);
var dataStubOptions = {
	startEpoch: d3.time.second.offset(now, -10).getTime(),
	endEpoch: now
};
var dataStubCollection = new DataStubCollection(null, dataStubOptions);

var dataLensOptions = {
	timeSpanInSeconds: 10
};
var dataLens = new DataLensCollection(null, dataStubCollection, dataLensOptions);

// main chart
var mainContainer = $('.dashboard .main-chart');

var mainChartModel = new ChartModel({
		name: 'Main Chart',
		width: mainContainer.width(),
		height: mainContainer.height()
	});

var mainChartView = new ChartView({
		model: mainChartModel,
		el: mainContainer,
		dataLens: dataLens
	});

mainChartView.setLatestData();
mainChartView.startLiveData();

//var timelineContainer = $('.dashboard .timeline-chart');
//
//var timelineChartModel = new ChartModel({
//		name: 'Timeline Chart',
//		width: timelineContainer.width(),
//		height: timelineContainer.height(),
//		useBrush: true,
//		timeSpanInSeconds: 10,
//		resolutionInSeconds: 1
//	});

// timeline chart
//var timelineChartView = new ChartView({
//		model: timelineChartModel,
//		el: timelineContainer
//	})
//	.on('brushChange', function(dateExtent){
//			mainChartView.stopLiveData();
//			mainChartView.setDataFromDateRange(dateExtent[0], dateExtent[1]);
//	});
//
//timelineChartView.setLatestData();

</script>

</body>
</html>